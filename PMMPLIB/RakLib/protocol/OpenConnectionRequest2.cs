using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using PMMPLIB.Utils.Linq;

namespace PMMPLIB.RakLib.protocol
{
    public class OpenConnectionRequest2 : Packet
    {
        public byte GetID() { return 0x07; }

        public System.Net.IPEndPoint ServerAddress { get; set; }
        public short MtuSize { get; set; }
        public long ClientId { get; set; }

        public void Encode(System.IO.MemoryStream stream)
        {
            stream.WriteByte(GetID());
            stream.Write(RakLib.MAGIC);
            stream.WriteAddress(ServerAddress);
            stream.WriteInt16BE(MtuSize);
            stream.WriteInt64(ClientId);//ummm...
        }

        public void Decode(System.IO.MemoryStream stream)
        {
            stream.ReadByte();//id
            stream.ReadBytes(16);//magic
            ServerAddress = stream.ReadAddress();
            MtuSize = stream.ReadInt16BE();
            ClientId = stream.ReadInt64();//ummm...
        }
    }
}
